(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(n,t,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return e(6844)}])},6844:function(n,t,e){"use strict";e.r(t),e.d(t,{default:function(){return P}});var r=e(5893),o=e(4051),a=e.n(o),i=e(2230);function u(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}function c(n,t,e,r,o,a,i){try{var u=n[a](i),c=u.value}catch(l){return void e(l)}u.done?t(c):Promise.resolve(c).then(r,o)}function l(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function i(n){c(a,r,o,i,u,"next",n)}function u(n){c(a,r,o,i,u,"throw",n)}i(void 0)}))}}function s(n){return function(n){if(Array.isArray(n))return u(n)}(n)||function(n){if("undefined"!==typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,t){if(!n)return;if("string"===typeof n)return u(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);"Object"===e&&n.constructor&&(e=n.constructor.name);if("Map"===e||"Set"===e)return Array.from(e);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return u(n,t)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var f=1024,d=function(){function n(t,e,r,o){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.running=!1,this.result=null,this.callback=void 0,this.audioContext=t,this.stream=e,this.encoder=r,this.resampleProcesser=null,o&&(this.callback=o)}var t=n.prototype;return t.start=function(){var n=this;return l(a().mark((function t(){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.audioContext.createMediaStreamSource(n.stream),t.next=3,n.audioContext.audioWorklet.addModule("/worklet-scripts/resample.worklet.js");case 3:n.resampleProcesser=new AudioWorkletNode(n.audioContext,"resample.worklet"),e.connect(n.resampleProcesser).connect(n.audioContext.destination),n.resampleProcesser.port.onmessage=function(){var t=l(a().mark((function t(e){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.running){t.next=2;break}return t.abrupt("return");case 2:n.encodeAudio(e.data);case 3:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}();case 6:case"end":return t.stop()}}),t)})))()},t.encodeAudio=function(n){var t=this;return l(a().mark((function e(){var r,o,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.running=!0,e.next=4,i.glt();case 4:if(u=Array.from(n),!(Math.max((r=Math).max.apply(r,s(u)),-(o=Math).min.apply(o,s(u)))<.01)){e.next=9;break}return t.running=!1,e.abrupt("return");case 9:return i.lub((function(){var e=i.RRF(n),r=i.J69(e),o=i.VV$(e),a=i.Fp7(e),u=i.IHx(i.hiC(i.luU(a,o),i.iD$(2)),i.iD$(1e-5)),c=i.hiC(i.luU(e,r),u),l=i.tdS.stft(c,f,1),s=i.XLQ(l,[513]),d=i.hiC(i.WnP(s),i.iD$(f)),p=i.tPi(d,1,512),h=i.XLQ(p,[1,32,16,1]),m=t.encoder.predict([h]),v=i.XLQ(m[1],[2]),y=Array.from(v.dataSync());t.result={coord:y},t.callback&&t.callback({coord:y})})),t.running=!1,e.next=13,i.glt();case 13:case"end":return e.stop()}}),e)})))()},n}(),p=e(7294),h=e(2734),m=e.n(h),v=e(5152);function y(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}function b(n,t,e,r,o,a,i){try{var u=n[a](i),c=u.value}catch(l){return void e(l)}u.done?t(c):Promise.resolve(c).then(r,o)}function w(n,t){return function(n){if(Array.isArray(n))return n}(n)||function(n,t){var e=null==n?null:"undefined"!==typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var r,o,a=[],i=!0,u=!1;try{for(e=e.call(n);!(i=(r=e.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(c){u=!0,o=c}finally{try{i||null==e.return||e.return()}finally{if(u)throw o}}return a}}(n,t)||_(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(n){return function(n){if(Array.isArray(n))return y(n)}(n)||function(n){if("undefined"!==typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||_(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(n,t){if(n){if("string"===typeof n)return y(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);return"Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e?Array.from(e):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?y(n,t):void 0}}var S=e.n(v)()((function(){return Promise.all([e.e(6),e.e(972)]).then(e.bind(e,6972)).then((function(n){return n.PlotLatentSketch}))}),{loadableGenerated:{webpack:function(){return[6972]}},ssr:!1}),A=2/11,k=function(n){var t=n.audioFilePath,e=n.encoderJSONPath,o=n.title,u=w(p.useState(null),2),c=u[0],l=u[1],s=p.useRef(null),f=w(p.useState(null),2),h=f[0],v=f[1];p.useEffect((function(){if(null===c){AudioContext=window.AudioContext||window.webkitAudioContext;var n=new AudioContext;n.suspend(),l(n)}}),[c]),p.useEffect((function(){if(null!==c&&null!==s.current){var n=s.current,t=n.captureStream?n.captureStream():n.mozCaptureStream?n.mozCaptureStream():null;v(t)}}),[c]);var y=w(p.useState(null),2),_=y[0],k=y[1],g=w(p.useState(null),2),j=g[0],P=g[1],C=w(p.useState([]),2),E=C[0],N=C[1],O=w(p.useState(null),2),I=O[0],T=O[1];p.useEffect((function(){if(null!==c&&null!==h&&null===_){var n=function(){var n,t=(n=a().mark((function n(){var t,r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.YLj(e);case 2:return t=n.sent,r=new d(c,h,t,P),k(_),n.next=7,r.start();case 7:case"end":return n.stop()}}),n)})),function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function i(n){b(a,r,o,i,u,"next",n)}function u(n){b(a,r,o,i,u,"throw",n)}i(void 0)}))});return function(){return t.apply(this,arguments)}}();n()}}),[_,c,h]),p.useEffect((function(){if(null!==j){var n=x(E).concat([j]),t=n.length<=10?n:n.slice(1);N(t)}}),[j]),p.useEffect((function(){var n=E.length;if(0!==n){var t=E[n-1];if(null===I||n<10){for(var e=[],r=0;r<t.coord.length;r++){for(var o=0,a=0;a<n;a++)o+=E[a].coord[r];e.push(o/n)}T({coord:e})}else{var i=I.coord.map((function(n,e){return n*(1-A)+t.coord[e]*A}));T({coord:i})}}}),[E]);var M=p.useCallback((function(){null!==c&&c.resume()}),[c]),J=p.useCallback((function(){null!==c&&c.suspend()}),[c]);return(0,r.jsxs)("div",{className:m().container,children:[o&&(0,r.jsx)("h4",{className:m().title,children:o}),(0,r.jsx)("audio",{src:t,controls:!0,loop:!0,ref:s,onPlay:M,onPause:J}),(0,r.jsxs)("p",{children:["first: ",null===I||void 0===I?void 0:I.coord[0]]}),(0,r.jsxs)("p",{children:["second: ",null===I||void 0===I?void 0:I.coord[1]]}),(0,r.jsx)(S,{canvasWidth:500,canvasHeight:500,encodeResult:I,className:m().sketch__container})]})},g=e(822),j=e.n(g),P=function(){return(0,r.jsxs)("div",{className:j().container,children:[(0,r.jsx)("h1",{children:"Timbre-VAE on browser"}),(0,r.jsxs)("div",{className:j().main__content,children:[(0,r.jsx)(k,{audioFilePath:"/audios/beginner.wav",encoderJSONPath:"/models/encoder01/model.json",title:"beginner"}),(0,r.jsx)(k,{audioFilePath:"/audios/intermediate.wav",encoderJSONPath:"/models/encoder01/model.json",title:"intermediate"}),(0,r.jsx)(k,{audioFilePath:"/audios/expert.wav",encoderJSONPath:"/models/encoder01/model.json",title:"expert"})]})]})}},822:function(n){n.exports={container:"Top_container__Kixnj",main__content:"Top_main__content__yMeYl"}},2734:function(n){n.exports={container:"VisualizeAudio_container__kpLYR",title:"VisualizeAudio_title__1xpJg",sketch__container:"VisualizeAudio_sketch__container__EJsRg"}},5410:function(){},8628:function(){},1601:function(){},7792:function(){},4977:function(){},5042:function(){}},function(n){n.O(0,[864,904,723,974,132,335,774,888,179],(function(){return t=8312,n(n.s=t);var t}));var t=n.O();_N_E=t}]);
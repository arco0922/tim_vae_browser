(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[958],{1752:function(r,n,e){r.exports=e(6949)},7760:function(r,n,e){"use strict";e.r(n),e.d(n,{AudioVisualizer:function(){return N}});var t=e(4051),o=e.n(t),s=e(5893),i=e(2230);function u(r,n,e,t,o,s,i){try{var u=r[s](i),a=u.value}catch(c){return void e(c)}u.done?n(a):Promise.resolve(a).then(t,o)}var a=function(){function r(n,e,t,o){!function(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}(this,r),this.isEncoding=!1,this.result=null,this.callback=void 0,this.isFlipped=n,this.encoder=e,this.preprocessor=t,o&&(this.callback=o)}return r.prototype.encodeAudio=function(r){var n,e=this;return(n=o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.isEncoding&&null!==r){n.next=2;break}return n.abrupt("return");case 2:return e.isEncoding=!0,n.next=5,i.glt();case 5:return i.lub((function(){var n=e.preprocessor(r),t=e.encoder.predict([n]),o=e.isFlipped?1:0,s=i.XLQ(t[o],[2]),u=Array.from(s.dataSync());e.result={coord:u},e.callback&&e.callback({coord:u})})),e.isEncoding=!1,n.next=9,i.glt();case 9:case"end":return n.stop()}}),n)})),function(){var r=this,e=arguments;return new Promise((function(t,o){var s=n.apply(r,e);function i(r){u(s,t,o,i,a,"next",r)}function a(r){u(s,t,o,i,a,"throw",r)}i(void 0)}))})()},r}(),c=e(7294),l=e(8982),f=e.n(l),d=e(5152),_=e.n(d),p=e(7979),v=e(7941),h=e(2916),m=e(4524),w=e(5952);function y(r,n){(null==n||n>r.length)&&(n=r.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=r[e];return t}function b(r,n,e,t,o,s,i){try{var u=r[s](i),a=u.value}catch(c){return void e(c)}u.done?n(a):Promise.resolve(a).then(t,o)}function k(r){return function(){var n=this,e=arguments;return new Promise((function(t,o){var s=r.apply(n,e);function i(r){b(s,t,o,i,u,"next",r)}function u(r){b(s,t,o,i,u,"throw",r)}i(void 0)}))}}function g(r,n){return function(r){if(Array.isArray(r))return r}(r)||function(r,n){var e=null==r?null:"undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=e){var t,o,s=[],i=!0,u=!1;try{for(e=e.call(r);!(i=(t=e.next()).done)&&(s.push(t.value),!n||s.length!==n);i=!0);}catch(a){u=!0,o=a}finally{try{i||null==e.return||e.return()}finally{if(u)throw o}}return s}}(r,n)||x(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(r){return function(r){if(Array.isArray(r))return y(r)}(r)||function(r){if("undefined"!==typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||x(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(r,n){if(r){if("string"===typeof r)return y(r,n);var e=Object.prototype.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(e):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?y(r,n):void 0}}var A=_()((function(){return e.e(157).then(e.bind(e,9157)).then((function(r){return r.PlotLatentSketch}))}),{loadableGenerated:{webpack:function(){return[9157]}},ssr:!1}),E=_()((function(){return e.e(640).then(e.bind(e,5640)).then((function(r){return r.DrawSamplingPointsSketch}))}),{loadableGenerated:{webpack:function(){return[5640]}},ssr:!1}),j=2/21,P=500,N=function(r){var n=r.audioFilePath,e=r.visualizerConfig,t=r.visualizeMode,u=r.annotations,l=r.title,d=g(c.useState(null),2),_=d[0],y=d[1];c.useEffect((function(){if(null===_){window.AudioContext=window.AudioContext||window.webkitAudioContext;var r=new AudioContext;y(r)}}),[]);var b=c.useRef(null),x=g(c.useState(null),2),N=x[0],C=x[1];c.useEffect((function(){if(null!==_&&null!==b.current&&null===N){var r=b.current,n=_.createMediaElementSource(r);C(n)}}),[_]);var T=g(c.useState(null),2),F=T[0],I=T[1];c.useEffect((function(){if(null!==_&&null===F){var r=function(){var r=k(o().mark((function r(){var n;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,_.audioWorklet.addModule("LONG_FAST"===e.encoderMode?(0,p.H)("/worklet-scripts/resample_mel.worklet.js"):(0,p.H)("/worklet-scripts/resample.worklet.js"));case 2:n=new AudioWorkletNode(_,"LONG_FAST"===e.encoderMode?"resample-mel.worklet":"resample.worklet",{parameterData:{bufferSize:e.frameLength,resampleRate:e.samplingRate}}),I(n);case 4:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();r()}}),[_,e]),c.useEffect((function(){null!==_&&null!==N&&null!==F&&N.connect(F).connect(_.destination)}),[_,N,F]);var L=g(c.useState(null),2),H=L[0],z=L[1],M=g(c.useState(null),2),O=M[0],R=M[1];c.useEffect((function(){var r=function(){var r=k(o().mark((function r(){var n,t;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,i.YLj((0,p.H)(e.encoderJSONPath));case 2:n=r.sent,t=new a(e.isFlipped,n,e.encoderPreprocessor,R),z(t);case 5:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();r()}),[e]),c.useEffect((function(){null!==F&&null!==H&&(F.port.onmessage=function(){var r=k(o().mark((function r(n){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:H.encodeAudio(n.data);case 1:case"end":return r.stop()}}),r)})));return function(n){return r.apply(this,arguments)}}())}),[F,H]);var W=g(c.useState([]),2),G=W[0],D=W[1],V=g(c.useState(null),2),B=V[0],J=V[1];c.useEffect((function(){if(null!==O){var r=S(G).concat([O]),n=r.length<=20?r:r.slice(1);D(n)}}),[O]),c.useEffect((function(){var r=G.length;if(0!==r){var n=G[r-1];if(null===B||r<20){for(var e=[],t=0;t<n.coord.length;t++){for(var o=0,s=0;s<r;s++)o+=G[s].coord[t];e.push(o/r)}J({coord:e})}else{var i=B.coord.map((function(r,e){return r*(1-j)+n.coord[e]*j}));J({coord:i})}}}),[G]);var Q=c.useCallback((function(){null!==_&&"running"!==_.state&&_.resume()}),[_]),U=c.useCallback((function(){null!==_&&"suspended"!==_.state&&_.suspend()}),[_]),X=g(c.useState(null),2),Y=X[0],$=X[1],q=g(c.useState(0),2),K=q[0],Z=q[1],rr=g(c.useState(null),2),nr=rr[0],er=rr[1];return c.useEffect((function(){if("LATENT"!==t){var r=new v.f(h.R.inputDim,h.R.outputDim);$(r)}}),[t]),c.useEffect((function(){if(null!==Y){var r=0,n=!0,e=!1,t=void 0;try{for(var o,s=Object.entries(u)[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var i=g(o.value,2),a=i[0],c=i[1],l=a,f=m.g[l];Y.addPoint(f,c),r+=1}}catch(d){e=!0,t=d}finally{try{n||null==s.return||s.return()}finally{if(e)throw t}}Z(r)}}),[u,Y]),c.useEffect((function(){if(null!==Y&&null!==B&&0!==K){var r=Y.estimate(B.coord),n=(0,w.H)(r);er(n)}}),[B,Y,K]),(0,s.jsxs)("div",{className:f().container,children:[l&&(0,s.jsx)("h4",{className:f().title,children:l}),(0,s.jsx)("audio",{src:(0,p.H)(n),controls:!0,loop:!0,ref:b,onClick:Q,onPlay:Q,onPause:U}),"LATENT"===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{children:["first: ",null===B||void 0===B?void 0:B.coord[0]]}),(0,s.jsxs)("p",{children:["second: ",null===B||void 0===B?void 0:B.coord[1]]}),(0,s.jsx)(A,{canvasWidth:P,canvasHeight:P,encodeResult:B,latentImgInfo:e.latentImgInfo,className:f().sketch__container})]}),"SHAPE"===t&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(E,{canvasWidth:P,canvasHeight:P,samplingPoints:nr})})]})}},4524:function(r,n,e){"use strict";e.d(n,{P:function(){return t},g:function(){return o}});var t=["rs1_00","rs1_01","rs1_02","rs2_00","rs2_01","rs2_02","rs2_03","rs2_04","rs2_05","rs2_06","rs2_07","rs2_08","rs2_09","rs2_10","rs2_11","rs2_12","rs2_13","rs2_14","rs2_15","rs2_16","rs2_17","rs2_18","rs2_19","rs2_20","rs2_21","rs2_22","rs2_23","rs2_24","rs2_25","rs2_26","rs2_27","rs2_28","rs2_29"],o={rs1_00:[2.1120596,-5.1291986],rs1_01:[1.5762187,2.60493],rs1_02:[-2.382232,.10038004],rs2_00:[2.5993729,-1.2009252],rs2_01:[-.94393796,-3.1945283],rs2_02:[.30973345,.21844022],rs2_03:[3.47645,1.0034096],rs2_04:[1.4669484,-3.0503924],rs2_05:[-.88771594,-1.2711746],rs2_06:[.83919644,-1.4324392],rs2_07:[1.8265278,.890573],rs2_08:[-1.0803591,1.0704242],rs2_09:[.2325852,-2.6102617],rs2_10:[.6404754,1.698138],rs2_11:[1.4612306,-.3326639],rs2_12:[2.6401613,1.8669294],rs2_13:[-1.0652071,-.106734954],rs2_14:[2.209707,-3.9786203],rs2_15:[2.5716124,-.07289239],rs2_16:[-1.5073073,-2.1868656],rs2_17:[.029848829,-.78534675],rs2_18:[1.55066,-2.0992553],rs2_19:[-.12433945,1.0623416],rs2_20:[-.06967662,-1.7259902],rs2_21:[1.2427349,-3.9178205],rs2_22:[1.7086548,-1.2185427],rs2_23:[-1.9910475,.89425653],rs2_24:[-1.8384401,-.5902677],rs2_25:[-.6483803,-2.3826134],rs2_26:[1.1159008,.4414356],rs2_27:[.52229494,-3.384752],rs2_28:[2.6333241,.76941025],rs2_29:[1.7951645,1.6901001]}},8982:function(r){r.exports={container:"AudioVisualizer_container__F_TNB",title:"AudioVisualizer_title__NWWgt",sketch__container:"AudioVisualizer_sketch__container__uaL9G"}}}]);